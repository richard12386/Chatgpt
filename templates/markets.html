<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Markets</title>
  <style>
    :root {
      --bg-1: #fdf6e3;
      --bg-2: #f4f7ff;
      --ink: #162029;
      --muted: #5f6b76;
      --panel: rgba(255, 255, 255, 0.9);
      --line: #d9dee4;
      --good: #0f766e;
      --bad: #c2410c;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      color: var(--ink);
      font-family: "Avenir Next", "Segoe UI", "Trebuchet MS", sans-serif;
      background:
        radial-gradient(circle at 10% 20%, #ffe7b0 0%, transparent 35%),
        radial-gradient(circle at 85% 10%, #c8e5ff 0%, transparent 40%),
        linear-gradient(140deg, var(--bg-1), var(--bg-2));
      min-height: 100vh;
    }
    .page {
      max-width: 1100px;
      margin: 0 auto;
      padding: 1.2rem 1rem 2rem;
    }
    .back {
      display: inline-block;
      text-decoration: none;
      font-weight: 800;
      color: #065f46;
      background: #ecfdf5;
      border: 1px solid #bbf7d0;
      border-radius: 10px;
      padding: 0.45rem 0.7rem;
      margin-bottom: 0.8rem;
    }
    h1 { margin: 0 0 0.7rem; }
    .market-board {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 0.8rem;
    }
    .market-card {
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 14px;
      box-shadow: 0 8px 20px rgba(22, 32, 41, 0.06);
      padding: 0.7rem;
    }
    .market-card h3 {
      margin: 0 0 0.45rem;
      font-size: 0.95rem;
      letter-spacing: 0.02em;
    }
    .market-list {
      margin: 0;
      padding: 0;
      list-style: none;
      display: grid;
      gap: 0.28rem;
      max-height: 320px;
      overflow: auto;
    }
    .market-item {
      display: grid;
      grid-template-columns: 1fr auto auto;
      gap: 0.45rem;
      align-items: center;
      border: 1px solid var(--line);
      border-radius: 10px;
      padding: 0.33rem 0.45rem;
      background: #fff;
      font-size: 0.82rem;
    }
    .market-item .sym { font-weight: 800; }
    .market-item .nm {
      color: var(--muted);
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }
    .market-item .meta { font-weight: 700; font-size: 0.8rem; }
    .pos { color: var(--good); }
    .neg { color: var(--bad); }
    .rec-card { grid-column: span 3; }
    @media (max-width: 900px) {
      .market-board { grid-template-columns: 1fr 1fr; }
      .rec-card { grid-column: span 2; }
    }
    @media (max-width: 620px) {
      .market-board { grid-template-columns: 1fr; }
      .rec-card { grid-column: span 1; }
    }
  </style>
</head>
<body>
  <main class="page">
    <a class="back" href="/">&larr; Back to homepage</a>
    <h1>Markets</h1>

    <section class="market-board">
      <article class="market-card">
        <h3>TOP 10 Most Active Buys</h3>
        <ul class="market-list">
          {% for row in market.active_buys %}
            <li class="market-item">
              <span><span class="sym">{{ row.symbol }}</span> <span class="nm">{{ row.name }}</span></span>
              <span class="meta pos">{% if row.change_pct is not none %}{{ "%.2f"|format(row.change_pct) }}%{% else %}N/A{% endif %}</span>
              <span class="meta">{{ "{:,}".format(row.volume) }}</span>
            </li>
          {% endfor %}
          {% if not market.active_buys %}<li class="market-item">No live data</li>{% endif %}
        </ul>
      </article>

      <article class="market-card">
        <h3>TOP 10 Most Active Sells</h3>
        <ul class="market-list">
          {% for row in market.active_sells %}
            <li class="market-item">
              <span><span class="sym">{{ row.symbol }}</span> <span class="nm">{{ row.name }}</span></span>
              <span class="meta neg">{% if row.change_pct is not none %}{{ "%.2f"|format(row.change_pct) }}%{% else %}N/A{% endif %}</span>
              <span class="meta">{{ "{:,}".format(row.volume) }}</span>
            </li>
          {% endfor %}
          {% if not market.active_sells %}<li class="market-item">No live data</li>{% endif %}
        </ul>
      </article>

      <article class="market-card">
        <h3>TOP 10 Gainers</h3>
        <ul class="market-list">
          {% for row in market.gainers %}
            <li class="market-item">
              <span><span class="sym">{{ row.symbol }}</span> <span class="nm">{{ row.name }}</span></span>
              <span class="meta pos">{% if row.change_pct is not none %}{{ "%.2f"|format(row.change_pct) }}%{% else %}N/A{% endif %}</span>
              <span class="meta">{% if row.price is not none %}{{ "%.2f"|format(row.price) }}{% else %}N/A{% endif %}</span>
            </li>
          {% endfor %}
          {% if not market.gainers %}<li class="market-item">No live data</li>{% endif %}
        </ul>
      </article>

      <article class="market-card">
        <h3>TOP 10 Losers</h3>
        <ul class="market-list">
          {% for row in market.losers %}
            <li class="market-item">
              <span><span class="sym">{{ row.symbol }}</span> <span class="nm">{{ row.name }}</span></span>
              <span class="meta neg">{% if row.change_pct is not none %}{{ "%.2f"|format(row.change_pct) }}%{% else %}N/A{% endif %}</span>
              <span class="meta">{% if row.price is not none %}{{ "%.2f"|format(row.price) }}{% else %}N/A{% endif %}</span>
            </li>
          {% endfor %}
          {% if not market.losers %}<li class="market-item">No live data</li>{% endif %}
        </ul>
      </article>

      <article class="market-card rec-card">
        <h3>5 Recommendations to Buy Stocks</h3>
        <ul class="market-list">
          {% for row in market.recommendations %}
            <li class="market-item">
              <span><span class="sym">{{ row.symbol }}</span> <span class="nm">{{ row.name }}</span></span>
              <span class="meta pos">{% if row.change_pct is not none %}{{ "%.2f"|format(row.change_pct) }}%{% else %}N/A{% endif %}</span>
              <span class="meta">Score {{ "%.3f"|format(row.score) }}</span>
            </li>
          {% endfor %}
          {% if not market.recommendations %}<li class="market-item">No live data</li>{% endif %}
        </ul>
      </article>
    </section>
  </main>
</body>
</html>
